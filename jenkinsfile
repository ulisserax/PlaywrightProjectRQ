pipeline {
   agent any
    tools { nodejs "default" }
    stages {
        stage('runing test') {
                        
            steps {
                // Depends on your language / test framework
                sh 'node -v'
                sh 'npm -v'
                sh 'npm install'
                sh 'npm run env:stage'
            }
        }

        stage ('SCM Checkout') {
            steps {
                script {
                    CI_ERROR = "Failed while checking out SCM"
                    
                }
            }
        }
    }

    post{
        success{
            slackSend( channel: "#playwright", token: "slack-token", color: "#00ff00", message: "${custom_msg()}")
        }
        failure{
            slackSend( channel: "#playwright", token: "slack-token", color: "#ff0000", message: "${custom_msg()}")
        }
        unstable{
            slackSend( channel: "#playwright", token: "slack-token", color: "#0000fe", message: "${custom_msg()}")
        }
    }
}

def custom_msg()
{
  def JENKINS_URL= env.JENKINS_URL
  def JOB_NAME = env.JOB_NAME
  def BUILD_ID= env.BUILD_ID
  def JENKINS_LOG= " FAILED: Job [${env.JOB_NAME}] Logs path: ${JENKINS_URL}/job/${JOB_NAME}/${BUILD_ID}/consoleText"
  return JENKINS_LOG
}